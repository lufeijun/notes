# 以一条简单的 select 语句分析 mysql 查询过程

  select * from T where id = 10;


## mysql 架构分层
  mysql 属于一个 C/S 软件，客户端连接服务端，发送请求，服务端处理返回结果


### server 层
  覆盖 mysql 的大多数核心服务功能，以及所有的内置函数，所有夸存储引擎的功能都在这里进行了实现；


  包含内容：
    1、连接器： 管理客户端连接，权限验证
    2、查询缓存：缓存查询的结果  sql 语句为 key，结果集为 value
    3、分析器：词法分析，语法分析
    4、优化器：定制执行计划，索引等选择
    5、执行器：对接操作引擎，接收返回的结果集


#### 连接器
  与客户端建立连接、获取权限，维持和管理连接；在获取到客户端权限之后，权限会被连接缓存，不再从数据库中获取，因此，在建立连接之后，如果改变此用户的权限，在不断开重连的情况下，
是不会生效的。类似于 mis 后台管理系统，登录之后，权限存储在 session 中，即使 admin 修改权限，如果管理员不退出重新登录，新的权限系统不会生效；


#### 查询缓存
  这块，除非是万年不变的那种数据，一般都不会开启缓存

#### 分析器
  词法分析：依据输入的语句判断 curd
  语法分析：判断 SQL 语句是否有错误

#### 优化器
  找到最优的数据查询方法

#### 执行器
  分析完 SQL 语句，判断出对应表的存储引擎，执行器便会调用对应存储引擎提供的接口去查找数据  


### 存储引擎层
  负责数据的存储和提取，架构为插件式的，ex：innodb、myisam







### 问题分析

  select k from T where id = 10 ， 如果 T 中没有 k 字段，会在那个阶段报错

  答案为：分析器







# 配置|SQL 说明
  1、show processlist；
    显示所有链接的客户端情况，如果 state 字段的值为 sleep，表示此链接的客户端处于空闲状态，
    在 mysql 中，如果客户端空闲时间过长，会被服务端主动释放掉，由参数 wait_timeout 控制，默认为 8 小时











# 问题列表

  1、存储引擎的概念，不同存储引擎的对比